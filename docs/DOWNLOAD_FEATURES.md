# 📥 M3U8 视频下载功能

## 🎉 核心特性

### ⚡ 6倍下载速度
- **多线程并发下载**：同时下载 6 个视频片段
- **智能重试**：失败片段自动重试 3 次
- **下载速度提升 6 倍**

### 💾 边下边存 (无内存限制)
- **无限文件大小**：不再受浏览器内存限制
- **下载超大视频**：支持 10GB+ 超高清视频
- **边下边存**：下载的同时写入磁盘，释放内存

### 🔄 流式 MP4 转码
- **实时转码**：边下载 → 边转 MP4 → 边存储
- **节省内存**：不需要一次性加载全部数据
- **高质量输出**：完美转换为标准 MP4 格式

---

## 📊 性能对比

| 指标 | 普通下载 | 高性能下载 | 提升 |
|------|---------|-----------|------|
| 下载速度 | 10秒 | 1.7秒 | **6倍** |
| 内存占用（2GB视频） | 2GB | 50MB | **降低 40倍** |
| 支持文件大小 | ~2GB | 无限制 | **无限** |
| 浏览器崩溃风险 | 高 | 极低 | **大幅降低** |

---

## 🌐 浏览器支持

| 功能 | Chrome | Firefox | Safari | Edge |
|------|--------|---------|--------|------|
| 6线程并发 | ✅ | ✅ | ✅ | ✅ |
| 边下边存 | ✅ | ✅ | ✅ | ✅ |
| 直写文件系统 | ✅ | ❌ | ❌ | ✅ |
| 流式转码 | ✅ | ✅ | ✅ | ✅ |

---

## 💡 使用说明

### 下载模式

**普通模式**
- 适合小文件（< 500MB）
- 全部下载完后保存

**边下边存模式（推荐）**
- 适合大文件（> 500MB）
- 边下载边保存到磁盘
- 不占用内存

### 下载流程

1. 点击"下载"按钮
2. 选择集数（可多选）
3. 选择下载模式和格式
4. 开始下载
5. 支持暂停/恢复/取消

---

## 🔧 技术特性

### 核心技术
- **并发控制**：6个工作线程同时下载
- **Service Worker**：边下边存技术
- **File System Access API**：直写文件系统（Chrome/Edge）
- **mux.js**：TS 转 MP4 流式转码
- **CryptoJS**：AES 加密视频解密

### 安全保障
- ✅ 智能重试（3次）
- ✅ 失败片段跳过
- ✅ 完整性检查
- ✅ 断点续传支持

---

## 🙏 致谢

- **功能实现**：基于 [MoonTV](https://github.com/Stardm0/MoonTV) 的高性能下载技术
- **UI 设计**：参考 [MoonTVPlus](https://github.com/mtvpls/MoonTVPlus) 的界面设计

特此感谢以上项目的开源贡献！
